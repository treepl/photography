'use strict';(function(k){function q(b,e){b=new URL(b);return(new URLSearchParams(b.search)).get(e)}k.createEventCalendarHolder=function(b,e){function f(a){c.classList.remove("md-size");c.classList.remove("sm-size");800>=a&&400<a?c.classList.add("md-size"):400>=a&&c.classList.add("sm-size")}const c=document.getElementById(b);var g="January February March April May June July August September October November December".split(" "),a=new Date;let h=a.getFullYear();var d=q(window.location.href,"CMSEventCalendarYear");
const k=a.getFullYear()+20;let p=a.getMonth();const l=q(window.location.href,"CMSEventCalendarMonth");a=`eventCalendar${a.getTime()}`;let n=c.parentElement.offsetWidth,m=`<calendar_loader class="calendar_treepl_loader"><svg class="spinner" width="65px" height="65px" viewBox="0 0 66 66" xmlns="http://www.w3.org/2000/svg"><circle class="path" fill="none" stroke-width="6" stroke-linecap="round" cx="33" cy="33" r="30"></circle></svg></calendar_loader><calendar_header class="calendar_treepl_header"><a href="javascript:" class="prev-month" onclick="goToEventCalendarPrevMonth('${a}', '${b}', ${e})"><svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M15.41 16.09l-4.58-4.59 4.58-4.59L14 5.5l-6 6 6 6z"/><path d="M0-.5h24v24H0z" fill="none"/></svg></a><div class="active_month"><div class="active_month_select"><select class="selectMonthDrop" onchange="createEventCalendar('${a}', '${b}', ${e})">`;
d&&2017<=+d&&+d<=k&&(h=+d);l&&(p=+l-1);800>=n&&400<n?c.classList.add("md-size"):400>=n&&c.classList.add("sm-size");for(d=0;d<g.length;d++)m+=`<option value="${d}">${g[d]}</option>`;m+=`</select></div><div class="active_month_select"><select class="selectYearDrop" onchange="createEventCalendar('${a}', '${b}', ${e})">`;for(g=0;g<k-2017;g++)d=2017+g,m+=`<option value="${d}">${d}</option>`;c.innerHTML=m+`</select></div></div><a href="javascript:" class="next-month" onclick="goToEventCalendarNextMonth('${a}', '${b}', ${e})"><svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M8.59 16.34l4.58-4.59-4.58-4.59L10 5.75l6 6-6 6z"/><path d="M0-.25h24v24H0z" fill="none"/></svg></a></calendar_header><calendar_treepl_body class="calendar_treepl_body" id="${a}"></calendar_treepl_body><calendar_modal style="display: none;" class="calendar_treepl_modal"></calendar_modal>`;
c.getElementsByClassName("selectMonthDrop")[0].value=p;c.getElementsByClassName("selectYearDrop")[0].value=h;window.addEventListener("resize",()=>{n=c.parentElement.offsetWidth;f(n)});f(n);createEventCalendar(a,b,e)};k.openEventCalendarMobileModalWindow=function(b,e){var f=document.getElementById(e);if(400<f.parentElement.offsetWidth)return!1;f=f.getElementsByClassName("calendar_treepl_modal")[0];var c=b.getElementsByClassName("calendar_table_event_holder")[0];b=new Date(+c.dataset.time);c=c.getElementsByTagName("a");
e=`<div class="calendar_treepl_modal_content"><div class="title-bar"><strong class="title">${b.toLocaleString("en-US",{year:"numeric",month:"long",day:"numeric"})}</strong><a href="javascript:" class="close" onclick="closeEventCalendarMobileModalWindow('${e}')"><svg fill="#9c9c9c" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z" /><path d="M0 0h24v24H0z" fill="none" /></svg></a></div><div class="modal-events-holder"><div class="modal-events-list">`;
for(let b of c)-1===b.className.indexOf("clear")&&(e+=`<div class="event"><a href="${b.getAttribute("href")}">${b.getAttribute("title")}</a></div>`);e+="</div></div></div>";f.innerHTML=e;f.style.display="block"};k.closeEventCalendarMobileModalWindow=function(b){b=document.getElementById(b).getElementsByClassName("calendar_treepl_modal")[0];b.style.display="none";b.innerHTML=""};k.goToEventCalendarPrevMonth=function(b,e,f){var c=document.getElementById(e);let g=c.getElementsByClassName("selectMonthDrop")[0];
c=c.getElementsByClassName("selectYearDrop")[0];let a=+g.value,h=+c.value,d=a-1;if(0==a&&2017==h)return!1;-1==d&&(d=11,--h);g.value=d;c.value=h;createEventCalendar(b,e,f)};k.goToEventCalendarNextMonth=function(b,e,f){var c=document.getElementById(e);let g=c.getElementsByClassName("selectMonthDrop")[0];c=c.getElementsByClassName("selectYearDrop")[0];let a=+g.value,h=+c.value,d=a+1;if(11==a&&h==+c.options[c.options.length-1].value)return!1;12==d&&(d=0,h+=1);g.value=d;c.value=h;createEventCalendar(b,
e,f)};k.createEventCalendar=function(b,e,f){function c(a){a=a.getDay();0==a&&(a=7);return a-1}let g=document.getElementById(b);var a=document.getElementById(e);let h=a.getElementsByClassName("calendar_treepl_loader")[0];f=""!=a.dataset.group?0!=a.dataset.group?a.dataset.group:"":-1==a.dataset.event_group?"":a.dataset.event_group==f?-1:a.dataset.event_group;b=a.dataset.module_id;var d=encodeURIComponent(a.dataset.category||"");let k=a.getElementsByClassName("selectMonthDrop")[0];a=a.getElementsByClassName("selectYearDrop")[0];
let p=+k.value;a=+a.value;let l=new Date(a,p),n=new Date;f=`?prop_ModuleId=${b}&prop_ongoingDate=${`${p+1}/1/${a}`}&prop_ParentId=${f}&prop_ItemCategories=${d}&jsonResponse=1`;let m='<div class="calendar_table"><div class="calendar_table_head"><div class="calendar_table_row"><div class="calendar_table_column">Mon</div><div class="calendar_table_column">Tue</div><div class="calendar_table_column">Wed</div><div class="calendar_table_column">Thu</div><div class="calendar_table_column">Fri</div><div class="calendar_table_column">Sat</div><div class="calendar_table_column">Sun</div></div></div><div class="calendar_table_body"><div class="calendar_table_row">';
b=new XMLHttpRequest;h.style.display="flex";for(d=0;d<c(l);d++)m+='<div class="calendar_table_column"><div class="calendar_table_date other-month"><span></span></div><div class="calendar_table_event_holder"></div></div>';b.onreadystatechange=function(){if(4==this.readyState&&200==this.status){var a=JSON.parse(this.responseText).items;for(a=a.sort(function(a,b){return(new Date(a.EventDateStart)).getTime()-(new Date(b.EventDateStart)).getTime()});l.getMonth()==p;){var b="",d=l.getTime();n.getMonth()==
l.getMonth()&&n.getDate()==l.getDate()&&(b="today");m+=`<div class="calendar_table_column" onclick="openEventCalendarMobileModalWindow(this, '${e}');"><div class="calendar_table_date ${b}"><span>${l.getDate()}</span></div><div class="calendar_table_event_holder" data-time="${d}"></div></div>`;6==c(l)%7&&(m+='</div><div class="calendar_table_row">');l.setDate(l.getDate()+1)}if(0!=c(l))for(b=c(l);7>b;b++)m+='<div class="calendar_table_column"><div class="calendar_table_date other-month"><span></span></div><div class="calendar_table_event_holder"></div></div>';
m+="</div></div></div>";g.innerHTML=m;b=g.getElementsByClassName("calendar_table_row");for(let c of a){a=c.EventDateStart.split(/[^0-9]/);d=c.EventDateEnd.split(/[^0-9]/);a=(new Date(a[0],a[1]-1,a[2],a[3],a[4],a[5])).getTime();d=(new Date(d[0],d[1]-1,d[2],d[3],d[4],d[5])).getTime();for(let e of b){var f=e.getElementsByClassName("calendar_table_event_holder");let b=0,g="";for(let e of f)if(e.dataset.time){f=+e.dataset.time;var k=f+864E5-1;let l=e.innerHTML,h=e.getElementsByTagName("a").length+1;if(k>
a&&d>f){let a=k="";0==b&&(k=c.Name,g=h,b++);if(g>h)for(let b=0;b<g-h;b++)a+='<a class="calendar_table_event clear"></a>';e.innerHTML=l+a+`<a href="${c.Url}" title="${c.Name.replace(/"/gim,"&#34;")}" class="calendar_table_event"><span>${k}</span></a>`}if(d<f)break}}}h.style.display="none"}};b.open("GET",f,!0);b.send()}})(window);
