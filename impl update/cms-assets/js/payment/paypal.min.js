'use strict';(function(){function l(){function d(b,d,f){"CreditCard"===d?(b.style.display="block",b.dataset.paymentEnabled=!0):(b.style.display="none",b.dataset.paymentEnabled=!1)}let e=document.forms,k=[],l={input:{"font-size":"17px","font-family":"helvetica, tahoma, calibri, sans-serif",color:"#3a3a3a"},":focus":{color:"black"}};for(let b=0;b<e.length;b++)if(e[b].elements.Payment_Data){let d=e[b];var g=d.getAttribute("name");let f=`${g}_${b}`,h=document.getElementById(`paymentFields_${g}`);g=document.getElementById(`paymentErrors_${g}`);
h.id=`paymentFields_${f}`;h.innerHTML=`<div class="cms_row"><div class="cms_col_6"><div class="cms_input_holder" id='card-number_${f}'></div></div><div class="cms_col_6"> <div class="cms_row"> <div class="cms_col_6" ><div class="cms_input_holder" id="expiration-date_${f}"></div></div><div class="cms_col_6" ><div class="cms_input_holder" id="cvv_${f}"></div></div></div></div></div>`;g.id=`paymentErrors_${f}`;d.setAttribute("name",f);k.push(e[b])}k&&k.forEach((b)=>{function e(a,b){let c=a.form;"CreditCard"===
c.elements.Payment_Type.value&&""===c.elements.Payment_Data.value?a.hostedFields.submit().then(function(a){a.orderId&&(c.elements.Payment_Data.value=a.orderId,b?b():f(c))}).catch(function(a){c.dataset.form_submitted=!1;alert(a.details[0].description)}):b?b():f(c)}function f(a){null===m(a.action,"jsonResponse")&&(a.action+=n(a.action)?"&":"?",a.action+="jsonResponse=1");fetch(a.action,{method:"POST",body:new FormData(a)}).then(function(a){return a.json()}).then(function(c){if(c.Error&&0!=c.Error)alert(c.ErrorMessages.join("\r\n")),
a.dataset.form_submitted=!1;else if(c.FormRedirectLink&&""!==c.FormRedirectLink){let d="SuccessPage";"Paypal"===b.elements.Payment_Type.value&&(d="PaymentRedirect");b.CMS_AfterFormPaymentHandled.data={FormRedirectLink:c.FormRedirectLink,LinkType:d,Response:c};a.dispatchEvent(a.CMS_AfterFormPaymentHandled)}})}let h=b.getAttribute("name"),g=document.getElementById(`paymentFields_${h}`),k=b["g-recaptcha-response-v3"]?"customFormSubmit":"submit";b.dataset.form_submitted=!1;paypal.HostedFields.render({styles:l,
createOrder:function(a,c){a={amount:b.querySelector("input[name='Payment_Amount']").dataset.total_price,PaymentType:"CreditCard",CustomerEmail:b.querySelector("input[name='Email']").value};return fetch(`/public/api/paypal/orders/${m(b.action,"form")}`,{method:"post",headers:{"content-type":"application/json"},body:JSON.stringify(a)}).then(function(a){return a.json()}).then(function(a){return a.Id})},fields:{number:{selector:`#card-number_${h}`,placeholder:"card number"},cvv:{selector:`#cvv_${h}`,
placeholder:"CVV"},expirationDate:{selector:`#expiration-date_${h}`,placeholder:"MM/YYYY"}},onError:function(a){alert(a)}}).then(function(a){b.addEventListener(k,function(c){c.preventDefault();c=c.target;"true"!==c.dataset.form_submitted?(b.CMS_AfterFormPaymentHandled=new Event("CMS_AfterFormPaymentHandled",{cancelable:!0}),c.CMS_CustomSubmit||(b.CMS_CustomSubmit=new Event("CMS_CustomSubmit",{cancelable:!0})),c.dataset.form_submitted=!0,b.CMS_CustomSubmit.data={form:b,hostedFields:a},e(b.CMS_CustomSubmit.data,
function(){b.dispatchEvent(b.CMS_CustomSubmit)})):alert("Form submission is in progress.")})});d(g,b.elements.Payment_Type.value,h);b.elements.Payment_Type.onchange=function(a){a.preventDefault();d(g,a.target.value,b.name)};b.addEventListener("CMS_CustomSubmit",function(a){a.defaultPrevented?a.data.form.dataset.form_submitted=!1:e(a.data)});b.addEventListener("CMS_triggerHandlePayment",function(a){if(a.data.response&&a.data.response.FormRedirectLink&&""!==a.data.response.FormRedirectLink){let c="SuccessPage";
"Paypal"===b.elements.Payment_Type.value&&(c="PaymentRedirect");b.CMS_AfterFormPaymentHandled.data={FormRedirectLink:a.data.response.FormRedirectLink,LinkType:c,Response:a.data.response};a.data.submitData.form.dispatchEvent(a.data.submitData.form.CMS_AfterFormPaymentHandled)}else e(a.data.submitData)});b.addEventListener("CMS_AfterFormPaymentHandled",function(a){a.defaultPrevented||(window.location=a.data.FormRedirectLink)})})}function m(d,e){d=new URL(d);return(new URLSearchParams(d.search)).get(e)}
function n(d){d=new URL(d);d=new URLSearchParams(d.search);let e=0;for(let k of d)e++;return e}document.addEventListener("DOMContentLoaded",function(d){setTimeout(()=>{l()},0)})})();
