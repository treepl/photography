'use strict';(function(){function u(){document.body.classList.add("cms_ose_activated");l();let a=p("ItemName");window.currentPageId=p("ItemId");let b=window.location.pathname;var c=h(window.location.href,"scroll");let d=!1,e=document.querySelectorAll("[data-cms_ose_add_new_item_button]"),f=[];for(let a=0;a<e.length;a++)f.push(e[a].dataset.cms_ose_add_new_item_button);c&&window.scroll(0,+c);if(document.querySelectorAll(`[data-cms_ose_edit_item_button="${window.currentPageId}"]`).length||document.querySelectorAll(`[data-cms_ose_item_id="${window.currentPageId}"]`).length)d=
!0;c=h(window.location.href,"notReload");window.parent.postMessage({message:"getModuleItemsByIds",value:{editableItemsIdArr:k(),notReload:c,currentPageName:a,currentPageHref:b,currentPageId:window.currentPageId,currentPageEditable:d,addNewItemModulesArr:f}},"*");m("click","[data-cms_ose_edit_item_button]",function(a){a=a.target.closest("[data-cms_ose_edit_item_button]").dataset.cms_ose_edit_item_button;window.parent.postMessage({message:"getItemProperties",value:a},"*");return!1});m("click","[data-cms_ose_add_new_item_button]",
function(a){a=a.target.closest("[data-cms_ose_add_new_item_button]").dataset.cms_ose_add_new_item_button;window.parent.postMessage({message:"getAddNewItemProperties",value:a},"*");return!1});m("click","[data-cms_ose_delete_item_button]",function(a){var b=a.target.closest("[data-cms_ose_delete_item_button]");a=b.dataset.cms_ose_delete_item_button;let c=b.closest("[data-cms_ose_module_id]").dataset.cms_ose_module_id;b=b.closest("[data-cms_ose_module_id]").dataset.index;window.parent.postMessage({message:"deleteModuleItem",
value:{itemId:a,moduleId:c,moduleIndex:b}},"*");return!1});window.addEventListener("message",(a)=>{switch(a.data.message){case "setupDataModuleIds":v(a.data.value.moduleMenuItems)}},!1);document.addEventListener("CMS_TriggerRefreshOSEItems",function(a){window.parent.postMessage({message:"refreshItemsListInTheMenu",value:{editableItemsIdArr:k()}},"*")})}function k(){let a=document.querySelectorAll("[data-cms_ose_item_id]"),b=[];for(let c=0;c<a.length;c++){let d=a[c].dataset.cms_ose_item_id;a[c].querySelectorAll(`[data-cms_ose_edit_item_button="${d}"]`).length&&
+d!==+window.currentPageId&&b.push(a[c].dataset.cms_ose_item_id)}return b}function v(a){a.forEach((a)=>{a.Items.forEach((b)=>{b=document.querySelectorAll(`[data-cms_ose_item_id="${b.Id}"]`);for(let c=0;c<b.length;c++)b[c].dataset.module_id=a.Id});w(`[data-module_id="${a.Id}"][data-cms_ose_item_id]`).dataset.cms_ose_module_id=a.Id})}function q(a,b,c,d,e,f){let g=new XMLHttpRequest;g.onload=g.onerror=function(){if(200==this.status)e&&("json"===d?e(JSON.parse(g.response)):"string"===d&&e(g.response));
else if(400==this.status){let a=JSON.parse(g.response).Message;f&&f(c);alert(a)}};g.open(a,b,!0);g.setRequestHeader("Content-Type","application/json");g.send(JSON.stringify(c))}function n(a){if("SCRIPT"===a.tagName===!0)a.parentNode.replaceChild(x(a),a);else for(var b=-1,c=a.childNodes;++b<c.length;)n(c[b]);return a}function x(a){var b=document.createElement("script");b.text=a.innerHTML;var c=-1;a=a.attributes;for(var d;++c<a.length;)b.setAttribute((d=a[c]).name,d.value);return b}function m(a,b,c){document.addEventListener(a,
function(a){let e=document.querySelectorAll(b);if(e){let b=a.target,d=-1;for(;b&&-1===(d=Array.prototype.indexOf.call(e,b));)b=b.parentElement;-1<d&&c.call(b,a)}},{once:!1})}function l(){let a=document.querySelectorAll("a");for(let e=0;e<a.length;e++){let f=a[e];var b=f.href;if(null===h(b,"enableOSEAdmin")&&-1===b.indexOf("javascript:")&&"#"!==b){let a=f.hash;f.href=b.replace(a,"");var c=f,d=c.href;if(b&&b.length){b=new URL(b);b=new URLSearchParams(b.search);let a=0;for(let c of b)a++;b=a}else b=
0;c.href=d+(b?"&":"?");f.href+=`enableOSEAdmin=true${a}`}}}function h(a,b){return a&&a.length?(a=new URL(a),(new URLSearchParams(a.search)).get(b)):null}function r(a,b){return a&&a.length?(a=new URL(a),a.searchParams.get(b)&&a.searchParams.delete(b),a.href):""}function p(a){for(let b=0;b<document.scripts.length;b++)if(-1!==document.scripts[b].src.indexOf("/cms-assets/js/ose/ose-pro.min.js"))return h(document.scripts[b].src,a)}function t(a){a=a.getBoundingClientRect();return{left:a.left+window.scrollX,
top:a.top+window.scrollY}}function w(a){a=document.querySelectorAll(a);if(1>a.length)return null;if(2>a.length)return a[0];const b=document.createRange();b.setStart(a[0],0);b.setEnd(a[a.length-1],a[a.length-1].childNodes.length);return b.commonAncestorContainer}document.addEventListener("DOMContentLoaded",function(a){u()});window.scrollToModule=function(a){a=document.querySelectorAll(`[data-cms_ose_module_id="${a}"]`)[0];window.scroll({top:t(a).top-100,left:0,behavior:"smooth"})};window.scrollToItem=
function(a){a=document.querySelectorAll(`[data-cms_ose_item_id="${a}"]`)[0];window.scroll({top:t(a).top-100,left:0,behavior:"smooth"})};window.reloadPageContent=function(){let a=window.scrollY,b=window.location.href.split("#")[0];b=r(b,"notReload");b=r(b,"scroll");window.location.href=b+"&notReload=true&scroll="+a};window.refreshItemContent=function(a,b){+window.currentPageId!==+a?q("GET",window.location.href,{},"string",function(c){let d=document.implementation.createHTMLDocument("New Document");
d.body.innerHTML=c;let e=d.body.querySelectorAll(`[data-cms_ose_item_id="${a}"]`);c=document.querySelectorAll(`[data-cms_ose_item_id="${a}"]`);c.length?c.forEach((c,d)=>{"true"===c.dataset.cms_ose_reload_page?window.reloadPageContent():e[d]?(c.outerHTML=e[d].outerHTML,n(c),c={itemId:a,moduleId:b},document.CMS_OSE_AfterEditedContentChanged=new Event("CMS_OSE_AfterEditedContentChanged",{cancelable:!0}),document.CMS_OSE_AfterEditedContentChanged.data=c,document.dispatchEvent(document.CMS_OSE_AfterEditedContentChanged),
l(),window.parent.postMessage({message:"frameContentLoaded",value:k()},"*")):window.refreshModuleHolder(b)}):window.refreshModuleHolder(b)}):window.reloadPageContent()};window.refreshModuleHolder=function(a){q("GET",window.location.href,{},"string",function(b){let c=document.implementation.createHTMLDocument("New Document");c.body.innerHTML=b;let d=c.body.querySelectorAll(`[data-cms_ose_module_id="${a}"]`);document.querySelectorAll(`[data-cms_ose_module_id="${a}"]`).forEach((b,c)=>{"true"===b.dataset.cms_ose_reload_page?
window.reloadPageContent():d[c]?(b.outerHTML=d[c].outerHTML,n(b),document.CMS_OSE_AfterEditedContentChanged=new Event("CMS_OSE_AfterEditedContentChanged",{cancelable:!0}),document.CMS_OSE_AfterEditedContentChanged.data={moduleId:a},document.dispatchEvent(document.CMS_OSE_AfterEditedContentChanged)):window.reloadPageContent()});l();window.parent.postMessage({message:"frameContentLoaded",value:k()},"*")})}})();
